<%= render "shared/second_header" %>

<div id='board-show-main'>
  <%# シフトボード内ヘッダー %>
  <div class='board-show-header'>
    <nav class="board-list-menu">
      <div class="board-list-menu-btn" id="board-list-menu">
        <i class="fas fa-angle-down fa-lg"></i>
      </div>
      <ul class="board-list-pulldown" id="board-list-pulldown" style="display:none;">
        <% current_owner.boards.each do |board| %>
          <li class="pulldown-list-each-board">
            <%= link_to board.name, board_shifts_path(board), class: "pulldown-board-link" %>
          </li>
        <% end %>
      </ul>
    </nav>
    <div class="board-name-btn" id="board-name-btn">
      <h2 id="board-name-text"><%= @board.name %></p>
    </div>

    <div class="invite-btn-wrapper">
      <i class="fas fa-user-plus lg" id="invite-btn"></i>
    </div>

    <div class="staff-list-wrapper">
      <% @board_staffs.each do |staff| %>
        <div class="member-list">
          <%= link_to "#{staff.last_name}", "#", class: "board-staff-link" %>
        </div>
      <% end %>
      <div id="add-staff"></div>
    </div>
  </div>

  <%# シフト表 %>
  <div class="main-shift-board">
    <div class="displayed-week">
      <%= "#{@first_day_str} - #{@last_day_str}" %>
    </div>
    <table class="shift-table">
      <tbody class="shift-table-body">
        <tr class="shift-table-date-row">
          <th class="date-cell-empty week"></th>
          <% @this_week_days.each do |d| %>
            <th class="date-cell week">
              <span><%= d[:day] %></span>
              <span><%= d[:wday] %></span>
            </th>
          <% end %>
        </tr>
        <% @this_week_shifts.each do |staff_shift| %>
          <tr class="each-staff-shift-row">
            <td class="staff-name-cell week">
              <p>
                <%= "#{staff_shift[:staff_ln]} #{staff_shift[:staff_fn]}" %>
              </p>
            </td>
            <% staff_shift[:days].each do |shifts| %>
              <td class="week-shift-cell week">
                <% shifts[:shift].each do |shift| %>
                  <div>
                    <%= "#{shift[:start_time]} - #{shift[:end_time]}" %>
                  </div>
                <% end %>
              </td>
            <% end %>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>

  <%# モーダルウィンドウ %>
  <div id="board-show-modal">
    <div id="board-edit-content">
      <button type="button" class="modal-close-btn" id="edit-close-btn">×</button>
      <%= form_with model: @board, url: "/boards/#{@board.id}", id: "edit-form" do |f| %>
        <h3 class="edit-header-text">シフトボード名の変更</h3>
        <%= f.text_field :name, id: "board-edit-name" %>
        <%= f.submit '変更する', id: "edit-submit-btn" %>
      <% end %>
    </div>

    <div id="board-invite-content">
      <button type="button" class="modal-close-btn" id="invite-close-btn">×</button>
      <h3 class="invite-header-text">ボードに招待</h3>
      <%= form_with model: @board_staff, url: "/boards/#{@board.id}/search", id: "invite-form" do |f| %>
        <div class="search-staff-name-group">
          <%= f.label :id_name, 'ユーザーID' %>
          <%= f.text_field :id_name, id: "invite-staff-name" %>
        </div>
        <button type="button" id="search-staff-btn">検索する</button>
        <p id="result-staff-name"></p>
        <p id="result-message"></p>
        <button  type="button", id="invite-staff-submit" >招待する</button>
      <% end %>
    </div>
  </div>
</div>